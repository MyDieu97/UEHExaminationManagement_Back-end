/*
Deployment script for New Database

This code was generated by a tool.
Changes to this file may cause incorrect behavior and will be lost if
the code is regenerated.
*/

GO
SET ANSI_NULLS, ANSI_PADDING, ANSI_WARNINGS, ARITHABORT, CONCAT_NULL_YIELDS_NULL, QUOTED_IDENTIFIER ON;

SET NUMERIC_ROUNDABORT OFF;


GO
:setvar DatabaseName "New Database"
:setvar DefaultFilePrefix "New Database"
:setvar DefaultDataPath "C:\Users\nhoxw\AppData\Local\Microsoft\Microsoft SQL Server Local DB\Instances\MSSQLLocalDB\"
:setvar DefaultLogPath "C:\Users\nhoxw\AppData\Local\Microsoft\Microsoft SQL Server Local DB\Instances\MSSQLLocalDB\"

GO
:on error exit
GO
/*
Detect SQLCMD mode and disable script execution if SQLCMD mode is not supported.
To re-enable the script after enabling SQLCMD mode, execute the following:
SET NOEXEC OFF; 
*/
:setvar __IsSqlCmdEnabled "True"
GO
IF N'$(__IsSqlCmdEnabled)' NOT LIKE N'True'
    BEGIN
        PRINT N'SQLCMD mode must be enabled to successfully execute this script.';
        SET NOEXEC ON;
    END


GO
USE [$(DatabaseName)];


GO
PRINT N'Creating [dbo].[DONGIACHAMTHI]...';


GO
CREATE TABLE [dbo].[DONGIACHAMTHI] (
    [ID]     INT          IDENTITY (1, 1) NOT NULL,
    [MALOAI] CHAR (10)    NULL,
    [LOAI]   VARCHAR (50) NULL,
    [DONGIA] MONEY        NULL,
    CONSTRAINT [PK_DONGIACHAMTHI] PRIMARY KEY NONCLUSTERED ([ID] ASC)
);


GO
PRINT N'Creating [dbo].[DONVI]...';


GO
CREATE TABLE [dbo].[DONVI] (
    [DONVIID]  INT           IDENTITY (1, 1) NOT NULL,
    [MADONVI]  CHAR (10)     NULL,
    [TENDONVI] VARCHAR (200) NULL,
    [SODT]     CHAR (10)     NULL,
    [EMAIL]    CHAR (50)     NULL,
    CONSTRAINT [PK_DONVI] PRIMARY KEY NONCLUSTERED ([DONVIID] ASC)
);


GO
PRINT N'Creating [dbo].[GIANGVIEN]...';


GO
CREATE TABLE [dbo].[GIANGVIEN] (
    [GVID]     INT           IDENTITY (1, 1) NOT NULL,
    [DONVIID]  INT           NOT NULL,
    [MAGV]     CHAR (10)     NOT NULL,
    [HOGV]     VARCHAR (100) NOT NULL,
    [TENGV]    VARCHAR (20)  NOT NULL,
    [GIOITINH] BIT           NOT NULL,
    [SODT]     CHAR (10)     NOT NULL,
    [EMAIL]    CHAR (50)     NOT NULL,
    [HUUTRI]   BIT           NOT NULL,
    [GHICHU]   TEXT          NULL,
    CONSTRAINT [PK_GIANGVIEN] PRIMARY KEY NONCLUSTERED ([GVID] ASC)
);


GO
PRINT N'Creating [dbo].[GIANGVIEN_CHAMTHI]...';


GO
CREATE TABLE [dbo].[GIANGVIEN_CHAMTHI] (
    [CHAMTHIID] INT   IDENTITY (1, 1) NOT NULL,
    [GVID]      INT   NULL,
    [LOPHPID]   INT   NULL,
    [SOBAITL]   INT   NULL,
    [SOBAIQT]   INT   NULL,
    [SOBAIKTHP] INT   NULL,
    [DGTL]      MONEY NULL,
    [DGQT]      MONEY NULL,
    [DGKTHP]    MONEY NULL,
    CONSTRAINT [PK_GIANGVIEN_CHAMTHI] PRIMARY KEY NONCLUSTERED ([CHAMTHIID] ASC)
);


GO
PRINT N'Creating [dbo].[GIANGVIEN_CHAMTHI].[CHAM_THI_FK]...';


GO
CREATE NONCLUSTERED INDEX [CHAM_THI_FK]
    ON [dbo].[GIANGVIEN_CHAMTHI]([GVID] ASC);


GO
PRINT N'Creating [dbo].[GIANGVIEN_COITHI]...';


GO
CREATE TABLE [dbo].[GIANGVIEN_COITHI] (
    [COITHIID]  INT     IDENTITY (1, 1) NOT NULL,
    [GVID]      INT     NULL,
    [LICHTHIID] INT     NULL,
    [ID]        INT     NOT NULL,
    [GIAMTHI]   TINYINT NULL,
    CONSTRAINT [PK_GIANGVIEN_COITHI] PRIMARY KEY NONCLUSTERED ([COITHIID] ASC)
);


GO
PRINT N'Creating [dbo].[GIANGVIEN_COITHI].[COI_THI_FK]...';


GO
CREATE NONCLUSTERED INDEX [COI_THI_FK]
    ON [dbo].[GIANGVIEN_COITHI]([GVID] ASC);


GO
PRINT N'Creating [dbo].[GIANGVIEN_COITHI].[PHAT_SINH2_FK]...';


GO
CREATE NONCLUSTERED INDEX [PHAT_SINH2_FK]
    ON [dbo].[GIANGVIEN_COITHI]([ID] ASC);


GO
PRINT N'Creating [dbo].[HOCPHAN]...';


GO
CREATE TABLE [dbo].[HOCPHAN] (
    [DONVIRADEID]   INT          NOT NULL,
    [DONVIQUANLYID] INT          NULL,
    [HOCPHANID]     INT          IDENTITY (1, 1) NOT NULL,
    [MAHP]          CHAR (10)    NULL,
    [SOTINCHI]      INT          NULL,
    [HEDAOTAO]      VARCHAR (50) NULL,
    CONSTRAINT [PK_HOCPHAN] PRIMARY KEY NONCLUSTERED ([HOCPHANID] ASC)
);


GO
PRINT N'Creating [dbo].[HOCPHAN].[PHU_TRACH2_FK]...';


GO
CREATE NONCLUSTERED INDEX [PHU_TRACH2_FK]
    ON [dbo].[HOCPHAN]([DONVIQUANLYID] ASC);


GO
PRINT N'Creating [dbo].[LICHTHI]...';


GO
CREATE TABLE [dbo].[LICHTHI] (
    [LICHTHIID]     INT           IDENTITY (1, 1) NOT NULL,
    [LOPHPID]       INT           NOT NULL,
    [PHIEUDIEMID]   INT           NULL,
    [PHIEUBAITHIID] INT           NULL,
    [THU]           VARCHAR (20)  NOT NULL,
    [NGAYTHI]       DATETIME      NOT NULL,
    [CSTHI]         CHAR (1)      NOT NULL,
    [PHONGTHI]      CHAR (4)      NOT NULL,
    [SOSV]          INT           NOT NULL,
    [HINHTHUCTHI]   VARCHAR (200) NULL,
    CONSTRAINT [PK_LICHTHI] PRIMARY KEY NONCLUSTERED ([LICHTHIID] ASC)
);


GO
PRINT N'Creating [dbo].[LICHTHI].[CUA5_FK]...';


GO
CREATE NONCLUSTERED INDEX [CUA5_FK]
    ON [dbo].[LICHTHI]([LOPHPID] ASC);


GO
PRINT N'Creating [dbo].[LOPHOCPHAN]...';


GO
CREATE TABLE [dbo].[LOPHOCPHAN] (
    [LOPHPID]      INT            IDENTITY (1, 1) NOT NULL,
    [LOPSVID]      INT            NULL,
    [HOCPHANID]    INT            NULL,
    [MALOPHP]      NCHAR (20)     NULL,
    [THOIKHOABIEU] NVARCHAR (100) NULL,
    CONSTRAINT [PK_LOPHOCPHAN] PRIMARY KEY NONCLUSTERED ([LOPHPID] ASC)
);


GO
PRINT N'Creating [dbo].[LOPHOCPHAN].[THUOC4_FK]...';


GO
CREATE NONCLUSTERED INDEX [THUOC4_FK]
    ON [dbo].[LOPHOCPHAN]([HOCPHANID] ASC);


GO
PRINT N'Creating [dbo].[LOPHOCPHAN].[CO4_FK]...';


GO
CREATE NONCLUSTERED INDEX [CO4_FK]
    ON [dbo].[LOPHOCPHAN]([LOPSVID] ASC);


GO
PRINT N'Creating [dbo].[LOPSV]...';


GO
CREATE TABLE [dbo].[LOPSV] (
    [LOPID]    INT            IDENTITY (1, 1) NOT NULL,
    [MALOP]    CHAR (5)       NULL,
    [NGANHHOC] VARCHAR (200)  NULL,
    [HEDAOTAO] NVARCHAR (100) NULL,
    CONSTRAINT [PK_LOPSV] PRIMARY KEY NONCLUSTERED ([LOPID] ASC)
);


GO
PRINT N'Creating [dbo].[PHANBOSOLUONGCBCT]...';


GO
CREATE TABLE [dbo].[PHANBOSOLUONGCBCT] (
    [DONVIID]     INT      NULL,
    [ID]          INT      IDENTITY (1, 1) NOT NULL,
    [NGAYTHI]     DATETIME NULL,
    [GIOTHI]      DATETIME NULL,
    [CSTHI]       CHAR (5) NULL,
    [SOLUONGCBCT] INT      NULL,
    CONSTRAINT [PK_PHANBOSOLUONGCBCT] PRIMARY KEY NONCLUSTERED ([ID] ASC)
);


GO
PRINT N'Creating [dbo].[PHANBOSOLUONGCBCT].[CO5_FK]...';


GO
CREATE NONCLUSTERED INDEX [CO5_FK]
    ON [dbo].[PHANBOSOLUONGCBCT]([DONVIID] ASC);


GO
PRINT N'Creating [dbo].[PHIEUGIAOBAITHI]...';


GO
CREATE TABLE [dbo].[PHIEUGIAOBAITHI] (
    [ID]         INT       IDENTITY (1, 1) NOT NULL,
    [MAPHIEU]    CHAR (10) NOT NULL,
    [DONVIID]    INT       NULL,
    [NGAYGIAO]   DATETIME  NULL,
    [HANNOP]     DATETIME  NULL,
    [SONGAYCHAM] INT       NULL,
    CONSTRAINT [PK_PHIEUGIAOBAITHI] PRIMARY KEY NONCLUSTERED ([ID] ASC)
);


GO
PRINT N'Creating [dbo].[PHIEUGIAOBANGDIEM]...';


GO
CREATE TABLE [dbo].[PHIEUGIAOBANGDIEM] (
    [ID]       INT       IDENTITY (1, 1) NOT NULL,
    [MAPHIEU]  CHAR (12) NOT NULL,
    [DONVIID]  INT       NOT NULL,
    [NGAYGIAO] DATETIME  NULL,
    CONSTRAINT [PK_PHIEUGIAOBANGDIEM] PRIMARY KEY NONCLUSTERED ([ID] ASC)
);


GO
PRINT N'Creating [dbo].[VIPHAMGV]...';


GO
CREATE TABLE [dbo].[VIPHAMGV] (
    [ID]           INT           IDENTITY (1, 1) NOT NULL,
    [DIEU]         CHAR (10)     NULL,
    [NOIDUNG]      VARCHAR (500) NULL,
    [HINHTHUCXULY] VARCHAR (500) NULL,
    [GVCOITHIID]   INT           NULL,
    CONSTRAINT [PK_VIPHAMGV] PRIMARY KEY NONCLUSTERED ([ID] ASC)
);


GO
PRINT N'Creating [dbo].[VIPHAMSV]...';


GO
CREATE TABLE [dbo].[VIPHAMSV] (
    [VIPHAMID]     INT           IDENTITY (1, 1) NOT NULL,
    [LICHTHIID]    INT           NOT NULL,
    [MSSV]         CHAR (15)     NOT NULL,
    [HOTEN]        VARCHAR (50)  NOT NULL,
    [NGAYSINH]     DATETIME      NOT NULL,
    [LOPSVID]      INT           NOT NULL,
    [MUCDOVP]      VARCHAR (300) NOT NULL,
    [HINHTHUCXULY] VARCHAR (100) NULL,
    CONSTRAINT [PK_VIPHAMSV] PRIMARY KEY NONCLUSTERED ([VIPHAMID] ASC)
);


GO
PRINT N'Creating [dbo].[VIPHAMSV].[PHAT_SINH_FK]...';


GO
CREATE NONCLUSTERED INDEX [PHAT_SINH_FK]
    ON [dbo].[VIPHAMSV]([LICHTHIID] ASC);


GO
PRINT N'Creating [dbo].[FK_GIANGVIE_TRUC_THUO_DONVI]...';


GO
ALTER TABLE [dbo].[GIANGVIEN] WITH NOCHECK
    ADD CONSTRAINT [FK_GIANGVIE_TRUC_THUO_DONVI] FOREIGN KEY ([DONVIID]) REFERENCES [dbo].[DONVI] ([DONVIID]);


GO
PRINT N'Creating [dbo].[FK_GIANGVIE_CHAM_THI_GIANGVIE]...';


GO
ALTER TABLE [dbo].[GIANGVIEN_CHAMTHI] WITH NOCHECK
    ADD CONSTRAINT [FK_GIANGVIE_CHAM_THI_GIANGVIE] FOREIGN KEY ([GVID]) REFERENCES [dbo].[GIANGVIEN] ([GVID]);


GO
PRINT N'Creating [dbo].[FK_GIANGVIE_CUA2_LOPHOCPHAN]...';


GO
ALTER TABLE [dbo].[GIANGVIEN_CHAMTHI] WITH NOCHECK
    ADD CONSTRAINT [FK_GIANGVIE_CUA2_LOPHOCPHAN] FOREIGN KEY ([LOPHPID]) REFERENCES [dbo].[LOPHOCPHAN] ([LOPHPID]);


GO
PRINT N'Creating [dbo].[FK_GIANGVIE_COI_THI_GIANGVIE]...';


GO
ALTER TABLE [dbo].[GIANGVIEN_COITHI] WITH NOCHECK
    ADD CONSTRAINT [FK_GIANGVIE_COI_THI_GIANGVIE] FOREIGN KEY ([GVID]) REFERENCES [dbo].[GIANGVIEN] ([GVID]);


GO
PRINT N'Creating [dbo].[FK_GIANGVIE_CUA_LICHTHI]...';


GO
ALTER TABLE [dbo].[GIANGVIEN_COITHI] WITH NOCHECK
    ADD CONSTRAINT [FK_GIANGVIE_CUA_LICHTHI] FOREIGN KEY ([LICHTHIID]) REFERENCES [dbo].[LICHTHI] ([LICHTHIID]);


GO
PRINT N'Creating [dbo].[FK_GIANGVIE_PHAT_SINH_VIPHAMGV]...';


GO
ALTER TABLE [dbo].[GIANGVIEN_COITHI] WITH NOCHECK
    ADD CONSTRAINT [FK_GIANGVIE_PHAT_SINH_VIPHAMGV] FOREIGN KEY ([ID]) REFERENCES [dbo].[VIPHAMGV] ([ID]);


GO
PRINT N'Creating [dbo].[FK_HOCPHAN_PHU_TRACH_DONVI]...';


GO
ALTER TABLE [dbo].[HOCPHAN] WITH NOCHECK
    ADD CONSTRAINT [FK_HOCPHAN_PHU_TRACH_DONVI] FOREIGN KEY ([DONVIQUANLYID]) REFERENCES [dbo].[DONVI] ([DONVIID]);


GO
PRINT N'Creating [dbo].[FK_HOCPHAN_PHU_TRACH_RA_DE_DONVI]...';


GO
ALTER TABLE [dbo].[HOCPHAN] WITH NOCHECK
    ADD CONSTRAINT [FK_HOCPHAN_PHU_TRACH_RA_DE_DONVI] FOREIGN KEY ([DONVIRADEID]) REFERENCES [dbo].[DONVI] ([DONVIID]);


GO
PRINT N'Creating [dbo].[FK_LICHTHI_GOM_PHIEUGIA]...';


GO
ALTER TABLE [dbo].[LICHTHI] WITH NOCHECK
    ADD CONSTRAINT [FK_LICHTHI_GOM_PHIEUGIA] FOREIGN KEY ([PHIEUDIEMID]) REFERENCES [dbo].[PHIEUGIAOBANGDIEM] ([ID]);


GO
PRINT N'Creating [dbo].[FK_LICHTHI_GOM2_PHIEUGIA]...';


GO
ALTER TABLE [dbo].[LICHTHI] WITH NOCHECK
    ADD CONSTRAINT [FK_LICHTHI_GOM2_PHIEUGIA] FOREIGN KEY ([PHIEUBAITHIID]) REFERENCES [dbo].[PHIEUGIAOBAITHI] ([ID]);


GO
PRINT N'Creating [dbo].[FK_LICHTHI_CUA5_LOPHOCPH]...';


GO
ALTER TABLE [dbo].[LICHTHI] WITH NOCHECK
    ADD CONSTRAINT [FK_LICHTHI_CUA5_LOPHOCPH] FOREIGN KEY ([LOPHPID]) REFERENCES [dbo].[LOPHOCPHAN] ([LOPHPID]);


GO
PRINT N'Creating [dbo].[FK_LOPHOCPH_THUOC4_HOCPHAN]...';


GO
ALTER TABLE [dbo].[LOPHOCPHAN] WITH NOCHECK
    ADD CONSTRAINT [FK_LOPHOCPH_THUOC4_HOCPHAN] FOREIGN KEY ([HOCPHANID]) REFERENCES [dbo].[HOCPHAN] ([HOCPHANID]);


GO
PRINT N'Creating [dbo].[FK_LOPHOCPH_CO4_LOPSV]...';


GO
ALTER TABLE [dbo].[LOPHOCPHAN] WITH NOCHECK
    ADD CONSTRAINT [FK_LOPHOCPH_CO4_LOPSV] FOREIGN KEY ([LOPSVID]) REFERENCES [dbo].[LOPSV] ([LOPID]);


GO
PRINT N'Creating [dbo].[FK_PHANBOSO_CO5_DONVI]...';


GO
ALTER TABLE [dbo].[PHANBOSOLUONGCBCT] WITH NOCHECK
    ADD CONSTRAINT [FK_PHANBOSO_CO5_DONVI] FOREIGN KEY ([DONVIID]) REFERENCES [dbo].[DONVI] ([DONVIID]);


GO
PRINT N'Creating [dbo].[FK_PHIEUGIA_GUI_DONVI]...';


GO
ALTER TABLE [dbo].[PHIEUGIAOBAITHI] WITH NOCHECK
    ADD CONSTRAINT [FK_PHIEUGIA_GUI_DONVI] FOREIGN KEY ([DONVIID]) REFERENCES [dbo].[DONVI] ([DONVIID]);


GO
PRINT N'Creating [dbo].[FK_PHIEUGIA_NHAN_DONVI]...';


GO
ALTER TABLE [dbo].[PHIEUGIAOBANGDIEM] WITH NOCHECK
    ADD CONSTRAINT [FK_PHIEUGIA_NHAN_DONVI] FOREIGN KEY ([DONVIID]) REFERENCES [dbo].[DONVI] ([DONVIID]);


GO
PRINT N'Creating [dbo].[FK_VIPHAMGV_CUA6_GVCOITHI]...';


GO
ALTER TABLE [dbo].[VIPHAMGV] WITH NOCHECK
    ADD CONSTRAINT [FK_VIPHAMGV_CUA6_GVCOITHI] FOREIGN KEY ([GVCOITHIID]) REFERENCES [dbo].[GIANGVIEN_COITHI] ([COITHIID]);


GO
PRINT N'Creating [dbo].[FK_VIPHAMSV_PHAT_SINH_LICHTHI]...';


GO
ALTER TABLE [dbo].[VIPHAMSV] WITH NOCHECK
    ADD CONSTRAINT [FK_VIPHAMSV_PHAT_SINH_LICHTHI] FOREIGN KEY ([LICHTHIID]) REFERENCES [dbo].[LICHTHI] ([LICHTHIID]);


GO
PRINT N'Creating [dbo].[FK_VIPHAMSV_THUOC_LOPSV]...';


GO
ALTER TABLE [dbo].[VIPHAMSV] WITH NOCHECK
    ADD CONSTRAINT [FK_VIPHAMSV_THUOC_LOPSV] FOREIGN KEY ([LOPSVID]) REFERENCES [dbo].[LOPSV] ([LOPID]);


GO
PRINT N'Checking existing data against newly created constraints';


GO
USE [$(DatabaseName)];


GO
ALTER TABLE [dbo].[GIANGVIEN] WITH CHECK CHECK CONSTRAINT [FK_GIANGVIE_TRUC_THUO_DONVI];

ALTER TABLE [dbo].[GIANGVIEN_CHAMTHI] WITH CHECK CHECK CONSTRAINT [FK_GIANGVIE_CHAM_THI_GIANGVIE];

ALTER TABLE [dbo].[GIANGVIEN_CHAMTHI] WITH CHECK CHECK CONSTRAINT [FK_GIANGVIE_CUA2_LOPHOCPHAN];

ALTER TABLE [dbo].[GIANGVIEN_COITHI] WITH CHECK CHECK CONSTRAINT [FK_GIANGVIE_COI_THI_GIANGVIE];

ALTER TABLE [dbo].[GIANGVIEN_COITHI] WITH CHECK CHECK CONSTRAINT [FK_GIANGVIE_CUA_LICHTHI];

ALTER TABLE [dbo].[GIANGVIEN_COITHI] WITH CHECK CHECK CONSTRAINT [FK_GIANGVIE_PHAT_SINH_VIPHAMGV];

ALTER TABLE [dbo].[HOCPHAN] WITH CHECK CHECK CONSTRAINT [FK_HOCPHAN_PHU_TRACH_DONVI];

ALTER TABLE [dbo].[HOCPHAN] WITH CHECK CHECK CONSTRAINT [FK_HOCPHAN_PHU_TRACH_RA_DE_DONVI];

ALTER TABLE [dbo].[LICHTHI] WITH CHECK CHECK CONSTRAINT [FK_LICHTHI_GOM_PHIEUGIA];

ALTER TABLE [dbo].[LICHTHI] WITH CHECK CHECK CONSTRAINT [FK_LICHTHI_GOM2_PHIEUGIA];

ALTER TABLE [dbo].[LICHTHI] WITH CHECK CHECK CONSTRAINT [FK_LICHTHI_CUA5_LOPHOCPH];

ALTER TABLE [dbo].[LOPHOCPHAN] WITH CHECK CHECK CONSTRAINT [FK_LOPHOCPH_THUOC4_HOCPHAN];

ALTER TABLE [dbo].[LOPHOCPHAN] WITH CHECK CHECK CONSTRAINT [FK_LOPHOCPH_CO4_LOPSV];

ALTER TABLE [dbo].[PHANBOSOLUONGCBCT] WITH CHECK CHECK CONSTRAINT [FK_PHANBOSO_CO5_DONVI];

ALTER TABLE [dbo].[PHIEUGIAOBAITHI] WITH CHECK CHECK CONSTRAINT [FK_PHIEUGIA_GUI_DONVI];

ALTER TABLE [dbo].[PHIEUGIAOBANGDIEM] WITH CHECK CHECK CONSTRAINT [FK_PHIEUGIA_NHAN_DONVI];

ALTER TABLE [dbo].[VIPHAMGV] WITH CHECK CHECK CONSTRAINT [FK_VIPHAMGV_CUA6_GVCOITHI];

ALTER TABLE [dbo].[VIPHAMSV] WITH CHECK CHECK CONSTRAINT [FK_VIPHAMSV_PHAT_SINH_LICHTHI];

ALTER TABLE [dbo].[VIPHAMSV] WITH CHECK CHECK CONSTRAINT [FK_VIPHAMSV_THUOC_LOPSV];


GO
PRINT N'Update complete.';


GO
